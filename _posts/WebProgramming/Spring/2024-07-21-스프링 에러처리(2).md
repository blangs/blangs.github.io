---
title:  "ìŠ¤í”„ë§ ì—ëŸ¬ì²˜ë¦¬(2) ë””í…Œì¼ ì»¤ìŠ¤í…€ì²˜ë¦¬"
excerpt: "ìŠ¤í”„ë§ ì—ëŸ¬ì²˜ë¦¬(2) ë””í…Œì¼ ì»¤ìŠ¤í…€ì²˜ë¦¬ ì…ë‹ˆë‹¤."

categories:
  - spring
tags:
  - [spring, í”„ë ˆì„ì›Œí¬]

toc: true
toc_sticky: true

last_modified_at: 2024-07-21T13:17:00-17:00:00
---


## ê°œìš”
> â—<span style='color:green'>***Bus***</span>  
> ğŸ’¡ 1.<span style='color:blue'>**ì„œë¡œì˜ ì„¸ì…˜ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì„ì„ í™•ì¸ í•¨.**</span>  



## êµ¬í˜„1 : ì»¤ìŠ¤í…€ìµì…‰ì…˜ 1depth
### BusinessExceptionHandler.java : Exception ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ì‘ì„±
```java
public class BusinessExceptionHandler extends RuntimeException {

	//ê³µí†µì ì¸ ErrorCode ì‹±ê¸€í†¤ ê°ì²´ì—ëŠ” ë°ì´í„°ë¥¼ SET í•œë‹¤. ê·¸ë¦¬ê³ 
    private ErrorCode errorCode;
    
    //ì§ì ‘ ì •ì˜í•œ ë©”ì„¸ì§€ë¥¼ ë³´ë‚´ê±°ë‚˜
    public BusinessExceptionHandler(String message, ErrorCode errorCode) {
        super(message);
        this.errorCode = errorCode;
    }

    //Errorì½”ë“œì— ì •ì˜ëœ ë©”ì„¸ì§€ë¥¼ ë³´ë‚´ê±°ë‚˜
    public BusinessExceptionHandler(ErrorCode errorCode) {
        super(errorCode.getMessage());
        this.errorCode = errorCode;
    }

    public ErrorCode getErrorCode() {
        return errorCode;
    }

}

```

### GlobalExceptionHandler.java : Exception ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ê°ì§€ ì¶”ê°€
```java
@ControllerAdvice
@Slf4j
public class GlobalExceptionHandler {
    ...
    /** [ì»¤ìŠ¤í…€ìµì…‰ì…˜] BusinessExceptionì—ì„œ ë°œìƒí•œ ì—ëŸ¬ **/
    @ExceptionHandler(BusinessExceptionHandler.class)
    protected ResponseEntity<ErrorResponse> handleCustomException(final BusinessExceptionHandler e) {
        log.debug("===========================================================");
        log.debug("[handleCustomException()] ì—¬ê¸°ë¡œ ì˜¤ëŠ”ê°€?!");
        log.debug("e.getMessage(): " + e.getMessage().toString());
        log.debug("e.getErrorCode(): " + e.getErrorCode().toString());
        log.debug("===========================================================");
        final ErrorCode errorCode = e.getErrorCode();
        final ErrorResponse response = ErrorResponse.of(errorCode); //ex)ENTITY_NOT_FOUND
        return new ResponseEntity<>(response, HttpStatus.valueOf(errorCode.getStatus()));
    }
    ...
}

```
  
> â—<span style='color:green'>***Exception ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ê°ì§€ ì¶”ê°€***</span>  
> ğŸ’¡ <span style='color:blue'>1.**BusinessExceptionHandler ì´ë¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë°œìƒí•˜ëŠ” Exception ì„ ê°ì§€í•˜ë„ë¡ ì²˜ë¦¬í–ˆë‹¤.**</span>  



## êµ¬í˜„ í…ŒìŠ¤íŠ¸
### ì‹¤í–‰
```java
    @ResponseBody
    @RequestMapping(value = "/app/testBindException", method = RequestMethod.GET)
    public String testBindException(@RequestParam(value = "name", required = false) String name) {
        try {
            int errorCALL = tB002Service.setInsert(new TB002()); //Exception ë°œìƒ
        } catch (Exception e) {
            throw new BusinessExceptionHandler(e.getMessage(), ErrorCode.INSERT_ERROR); //ì»¤ìŠ¤í…€ìµì…‰ì…˜ ì˜ˆì™¸ ë˜ì§€ê¸°
        }
		return "";

    }
	
```


### ì„œë²„ ê²°ê³¼
```bash
[2024-07-21 19:26:55] DEBUG: com.blang.bck.comm.error.GlobalExceptionHandler - ===========================================================
[2024-07-21 19:26:55] DEBUG: com.blang.bck.comm.error.GlobalExceptionHandler - [handleCustomException()] ì—¬ê¸°ë¡œ ì˜¤ëŠ”ê°€?!
[2024-07-21 19:26:55] DEBUG: com.blang.bck.comm.error.GlobalExceptionHandler - e.getMessage(): 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'íšŒì›ì¼ë ¨ë²ˆí˜¸' cannot be null
### The error may involve com.blang.bck.mappers.web.TB002Mapper.TB002Insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO TB002 ~~ ë‚´ìš©
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'ì¼ë ¨ë²ˆí˜¸' cannot be null
; SQL []; Column 'ì¼ë ¨ë²ˆí˜¸' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'ì¼ë ¨ë²ˆí˜¸' cannot be null
[2024-07-21 19:26:55] DEBUG: com.blang.bck.comm.error.GlobalExceptionHandler - e.getErrorCode(): INSERT_ERROR
[2024-07-21 19:26:55] DEBUG: com.blang.bck.comm.error.GlobalExceptionHandler - ===========================================================

```


### ë¸Œë¼ìš°ì € ì‘ë‹µ
```json
{
    "status": 200,
    "code": "9999",
    "message": "Insert Transaction Error Exception",
    "errors": [],
    "reason": null
}

```

## êµ¬í˜„2 : ì»¤ìŠ¤í…€ìµì…‰ì…˜ 2depth
### ê°œìš” 
```java
throw new BusinessExceptionHandler(e.getMessage(), ErrorCode.INSERT_ERROR); //ì»¤ìŠ¤í…€ìµì…‰ì…˜ ì˜ˆì™¸ ë˜ì§€ê¸°
```

> â—<span style='color:green'>***ì´ë ‡ê²Œ ì¦‰ì‹œ ë˜ì§€ëŠ” ê²ƒì€ ì˜ë¯¸ê°€ ì—†ë‹¤. ì¡°ê¸ˆ ë” êµ¬ì¡°í™” í•´ë³´ì.***</span>  


### EntityNotFoundException.java : ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ì„¸ë¶€ìµì…‰ì…˜ í´ë˜ìŠ¤ ì‘ì„±
```java
public class EntityNotFoundException extends BusinessExceptionHandler {

	/***********************************
	 * EntityNotFoundException : ê° ì—”í‹°í‹°ë“¤ì„ ëª»ì°¾ì•˜ì„ ê²½ìš°
	 * - DAOë“±ë“±.. findById, findByCode ë©”ì„œë“œì—ì„œ ì¡°íšŒê°€ ì•ˆë˜ì—ˆì„ ê²½ìš°
	 ***********************************/
    public EntityNotFoundException(String message) {
        super(message, ErrorCode.ENTITY_NOT_FOUND);
    }
}

```

### EntityNotFoundException.java : ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ì„¸ë¶€ìµì…‰ì…˜ í´ë˜ìŠ¤ ì‘ì„±
```java
public class HOme extends BusinessExceptionHandler {

	/***********************************
	 * EntityNotFoundException : ê° ì—”í‹°í‹°ë“¤ì„ ëª»ì°¾ì•˜ì„ ê²½ìš°
	 * - DAOë“±ë“±.. findById, findByCode ë©”ì„œë“œì—ì„œ ì¡°íšŒê°€ ì•ˆë˜ì—ˆì„ ê²½ìš°
	 ***********************************/
    public EntityNotFoundException(String message) {
        super(message, ErrorCode.ENTITY_NOT_FOUND);
    }
}

```