---
title:  "ë¦¬ì•¡íŠ¸ ìµœì í™”(2) ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸"
excerpt: "ë¦¬ì•¡íŠ¸ ìµœì í™”(2) ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ ì…ë‹ˆë‹¤."

categories:
  - react
tags:
  - [react]

toc: true
toc_sticky: true

last_modified_at: 2023-08-03T09:00:00-18:00:00
---

## React.memo ë€?
### ì˜ˆì œ
```js
const MyComponent = React.memo(({ name }) => {
    return <div>Hello, {name}!</div>;
});

```  

> â—***React.memo ê³¼ì •***  
> ğŸ’¡ ìœ„ì˜ MyComponent ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” nameì´ë¼ëŠ” propsë¥¼ ì‚¬ìš©.  
> ğŸ’¡ React.memoëŠ” ì´ì „ì— ë Œë”ë§ëœ ê²°ê³¼ë¥¼ name ê°’ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ë¥¼ ë¹„êµ.  
> ğŸ’¡ ë³€ê²½ì´ë©´ ì¬ëœë”ë§ / ê·¸ëŒ€ë¡œë©´ ì¬ì‚¬ìš©.  



## ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ ìµœì í™”
> â—***í•„ìˆ˜ê°œë…***  
> ğŸ’¡ ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë¦¬ìŠ¤íŠ¸ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë„ ìµœì í™” í•´ì•¼í•œë‹¤.(ê¶Œì¥)  
> ğŸ’¡ ë¦¬ìŠ¤íŠ¸ëŠ” ë°˜ë³µì ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì´ë‹¤. (ê°±ì‹ ì´ ê³„ì† ì¼ì–´ë‚œë‹¤.)

### ScheduleBoard.js
```js
import React, { useRef, useState, useCallback } from 'react';
import TodoTemplate from './TodoTemplate';
import TodoInsert from './TodoInsert';
import TodoList from './TodoList';

function createBulkTodos() {
    const array = [];
    for(let i=1; i<2500; i++) {
        array.push( { id: i, text: `í•  ì¼ ${i}`, checked: false } );
    }

    return array;
}

const ScheduleBoard = () => {

    const [todos, setTodos] = useState(createBulkTodos);

    const nextId = useRef(todos.length);

    // ì‚½ì…
    // ê°±ì‹  ë˜ì§€ì§€ì•Šì§€ë§Œ ì ‘ê·¼ ë°©ë²•ì„ ìì‹ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¯¸ë¦¬ useMemo í•´ë†¨ë‹¤. ê·¸ë˜ì„œ ì˜¤ë²„í—¤ë“œëŠ” ì—†ë‹¤.
    const onInsert = useCallback( (text) => {
        const temp = {
            id: nextId.current += 1
            , text: text
            , checked: false
        };
        setTodos(todos.concat(temp));
    }, []);

    // ì‚­ì œ
    const onRemove = useCallback( (id) => {
        setTodos(todos => (todos.filter((todo) => todo.id !== id)));
    }, []);

    // í† ê¸€
    const onToggle = useCallback( (id) => {
        setTodos(todos => ( 
                            todos.map((todo) => 
                                todo.id === id ? { ...todo, checked: !todo.checked } : todo,
                            )
        ));
            
    }, []);
    
    return (
        <div>
            <h1>ScheduleBoard Page</h1>

            <TodoTemplate>
                <TodoInsert onInsert={onInsert} />
                <TodoList todos={todos} onRemove={onRemove} onToggle={onToggle} />
            </TodoTemplate>
        </div>

    );
};

export default ScheduleBoard;

```

> â—***ì´ì „ í¬ìŠ¤íŒ… ì²˜ëŸ¼ ìµœì í™”ê°€ ëœ ìƒíƒœì´ë‹¤.***  
> ğŸ’¡ ì—¬ê¸°ì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” <TodoList /> ë¥¼ ì§‘ì¤‘í•´ì„œ ë³´ì.  
> ğŸ’¡ ë“±ë¡ëœ props ëŠ” [todos], [onRemove], [onTogle] ì´ë‹¤.  
>   
> â—***í˜„ì¬ ë¦¬ë Œë”ë§ ì¡°ê±´***  
> ğŸ’¡ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§  
> ğŸ’¡ todos ìƒíƒœ ë³€ê²½  
> ğŸ’¡ onInsert, onRemove, onToggle í•¨ìˆ˜ì˜ ë³€ê²½ ì‹œì ì— ë¦¬ë Œë”ë§  


### TodoList.js

- AS-IS

    ```js
    import TodoListItem from './TodoListItem';
    import '../TodoList.scss';

    const TodoList = ({ todos, onRemove, onToggle }) => {

        return (
            // ë¦¬ìŠ¤íŠ¸ ìƒì„¸ ì»´í¬ë„ŒíŠ¸
            <div className="TodoList">
                {todos.map(todo => (
                    <TodoListItem
                        todo={todo}
                        key={todo.id}
                        onRemove={onRemove}
                        onToggle={onToggle}
                    />
                ))}
            </div>

        );
    };

    export default TodoList;
    
    ```

- TO-BE   

    ```js
    import React from 'react';
    import TodoListItem from './TodoListItem';
    import '../TodoList.scss';

    const TodoList = ({ todos, onRemove, onToggle }) => {

        return (
            // ë¦¬ìŠ¤íŠ¸ ìƒì„¸ ì»´í¬ë„ŒíŠ¸
            <div className="TodoList">
                {todos.map(todo => (
                    <TodoListItem
                        todo={todo}
                        key={todo.id}
                        onRemove={onRemove}
                        onToggle={onToggle}
                    />
                ))}
            </div>

        );
    };

    export default React.memo(TodoList);  
    // React.Memo ì‚¬ìš©
    // todos, onRemove, onToggle í”„ë¡­ìŠ¤ê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ ì¬ë Œë”ë§ì„ ë°©ì§€í•¨.
    
    ```

    > â—***React.memo ê¸°ëŠ¥ìœ¼ë¡œ ë°©ì§€ë˜ëŠ” í•­ëª©***  
    > ***ë¦¬ì•¡íŠ¸ ë Œë”ë§ ì¡°ê±´ê³¼ TodoList  ë¹„êµ***  
    > - ğŸ’¡ <span style="color:green"><b><I>ìì‹ ì´ ì „ë‹¬ë°›ì€ propsê°€ ë³€ê²½ë  ë•Œ</I></b></span>  
    >     - todos, onRemove, onToggle í”„ë¡­ìŠ¤ë¥¼ ì „ë‹¬ë°›ê³  ìˆë‹¤.  
    >     - TodoList ì»´í¬ë„ŒíŠ¸ê°€ React.memo ê¸°ëŠ¥ìœ¼ë¡œ ì¸í•´ ìœ„ í”„ë¡­ìŠ¤ê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ”í•œ ë¦¬ëœë”ë§ ë˜ì§€ ì•ŠëŠ”ë‹¤.  
    > - ğŸ’¡ <span style="color:green"><b><I>ìì‹ ì˜ stateê°€ ë°”ë€” ë•Œ</I></b></span>
    >     - TodoList ì»´í¬ë„ŒíŠ¸ëŠ” ìƒíƒœ(state)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•Šìœ¼ë¯€ë¡œ, í•´ë‹¹ ìƒí™©ì€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
    > - ğŸ’¡ <span style="color:green"><b><I>ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œ</I></b></span>
    >     - ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œë§ˆë‹¤ ScheduleBoard ì»´í¬ë„ŒíŠ¸ì˜ ë‚´ìš©ì´ ì¬ìƒì„±ë  ìˆ˜ ìˆë‹¤.
    >     - ì¦‰, ì´ ë§ì€ TodoList ìì‹ ì»´í¬ë„ŒíŠ¸ë„ ì¬ë Œë”ë§ë  ê°€ëŠ¥ì„±ì´ ìˆë‹¤.  
    >     - ```js
    >       ì°¸ê³ ë¡œ í˜„ì¬ëŠ” ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ê°€ ì¬ëœë”ë§ ìˆ˜í–‰í•˜ëŠ” ì¡°ê±´ì€ ìµœì í™”ë¥¼ ì ìš© í–ˆê¸°ì— ë³„ë¡œ ì—†ë‹¤. ì•„ë˜ ë‚´ìš©ì´ ì¡´ì¬ í•  ìˆ˜ ìˆë‹¤. 
    >       
    >       // ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ì˜ ëœë”ë§ ê°€ëŠ¥ì„± 
    >       1. ì´ˆê¸° ë§ˆìš´íŠ¸ì‹œì  ëœë”ë§
    >       2. ê° í•¨ìˆ˜ ë³€ê²½ì‹œ ëœë”ë§ (ì •í™•íˆëŠ” todos ë³€ê²½ì‹œ ëœë”ë§ ë˜ì–´ì§)
    >       3. ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ ë¦¬ëœë”ë§ ì‹œì ì— ëœë”ë§
    >       ```
    > - ğŸ’¡ <span style="color:green"><b><I>forcUpdate í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œ</I></b></span>
    >     - forceUpdate í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ë˜ ê°•ì œë¡œ ë¦¬ë Œë”ë§ëœë‹¤.


### ìµœì í™” ì™„ë£Œ(ì •ë¦¬)
> â—***ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ ìµœì í™” (í•„ìˆ˜ê°œë…)***  
> ğŸ’¡ <span style="color:green"><b><I>(1). ë¶€ëª¨ ScheduleBoard ì»´í¬ë„ŒíŠ¸ì˜ onInsert, onRemove, onToggle í•¨ìˆ˜ë“¤ì€ ëª¨ë‘ todos ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§Œ ìƒˆë¡œ ìƒì„±ëœë‹¤.</I></b></span>  
>   - ë¹„ ì˜ì¡´ì„± useCallback í›…ì„ ì‚¬ìš©í•˜ì—¬ í•¨ìˆ˜ë¥¼ ìµœì í™”í•˜ê³ , í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì°¸ì¡°í•˜ëŠ” ì™¸ë¶€ ë³€ìˆ˜(ì—¬ê¸°ì„œëŠ” todos)ê°€ ë³€ê²½ë˜ì—ˆì„ ë•Œë§Œ ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ë„ë¡ ì„¤ì •í–ˆë‹¤.
>   - ì¦‰, todos ê°€ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©´ í•¨ìˆ˜ëŠ” ëœë”ë§ë˜ì§€ ì•ŠëŠ” ë©‹ì§„ ìƒíƒœë¡œ ë§Œë“¤ì–´ë†¨ë‹¤.
> 
> ğŸ’¡ <span style="color:green"><b><I>(2). ìì‹ TodoList ì»´í¬ë„ŒíŠ¸ëŠ” React.memo ìœ¼ë¡œ ì¸í•´ í”„ë¡­ìŠ¤ê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ ì¬ë Œë”ë§ì„ ë°©ì§€í•œë‹¤.</I></b></span>  
>   - ê·¸ëŸ°ë° 1ë²ˆì—ì„œ ë¬´ë¶„ë³„í•œ í•¨ìˆ˜ìƒì„± ìµœì í™”ë¥¼ ë¯¸ë¦¬ í•´ë‘” todos ê°€ í˜„ì¬ TodoListì˜ í”„ë¡­ìŠ¤ë¡œ ì‚¬ìš©ë˜ê³  ìˆë‹¤.  
>    
> ğŸ’¡ <span style="color:green"><b><I>(3). ê²°ë¡ ì ìœ¼ë¡œ ScheduleBoard ì»´í¬ë„ŒíŠ¸ì—ì„œ onInsert, onRemove, onToggle í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ë„, ì „ë‹¬ë°›ì€ todosê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ TodoList ì»´í¬ë„ŒíŠ¸ëŠ” ì¬ë Œë”ë§ì„ ì•ˆí•œë‹¤.</I></b></span>
>   - ë³€ê²½ë˜ì§€ ì•Šì€ ë…€ì„ì€ í•¨ìˆ˜ê°€ ê°±ì‹ ë˜ì§€ ì•Šì„ ê²ƒì´ê³ ,
>   - í•¨ìˆ˜ê°€ ê°±ì‹ ë˜ì§€ ì•Šì•„ì„œ ìì‹ì»´í¬ë„ŒíŠ¸ì— ì „ë‹¬ëœ í”„ë¡­ìŠ¤ë„ ê·¸ëŒ€ë¡œë¼ì„œ ê°±ì‹ ë˜ì§€ ì•ŠëŠ”ë‹¤.



## react-virtualized ìµœì í™”
> â—***React.memo ê³¼ì •***  
> ğŸ’¡ 2500ê°œì˜ í•  ì¼ ë¦¬ìŠ¤íŠ¸ê°€ ìˆì§€ë§Œ ì‚¬ìš©ì ëˆˆì— ë³´ì´ëŠ” ê°¯ìˆ˜ëŠ” 9ê°œ ì •ë„ë°–ì— ì—†ë‹¤.  
> ğŸ’¡ ê·¸ëŸ¼ ë‚˜ë¨¸ì§€ 2,491ê°œì˜ ì»´í¬ë„ŒíŠ¸ëŠ” ìŠ¤í¬ë¡¤í•˜ê¸° ì „ê¹Œì§€ ë Œë”ë§í•˜ì§€ ì•Šê³  í¬ê¸°ë§Œ ë˜ì ¸ë‘ê²Œë” í•˜ëŠ” ë°©ë²•ì´ë‹¤.
> ğŸ’¡ ë³€ê²½ì´ë©´ ì¬ëœë”ë§ / ê·¸ëŒ€ë¡œë©´ ì¬ì‚¬ìš©.  







### STEP1. react-virtualized ì„¤ì¹˜
```js
yarn add react-virtualized

```

### STEP2. ë¦¬ìŠ¤íŠ¸ë¡œ ë¿Œë ¤ì§ˆ ê° í•­ëª©ì˜ í¬ê¸° ì•Œì•„ë‚´ê¸°
```js
  return (
    <List
      className="TodoList"
      width={512}   // ì „ì²´ í¬ê¸°
      height={513}  // ì „ì²´ ë†’ì´
      rowCount={todos.length}  // í•­ëª© ê°œìˆ˜
      rowHeight={57}           // í•­ëª© ë†’ì´
      rowRenderer={rowRenderer} // í•­ëª©ì„ ë Œë”ë§í•  ë•Œ ì“°ëŠ” í•¨ìˆ˜
      list={todos} // ë°°ì—´
      style={{ outline: 'none' }} // Listì— ê¸°ë³¸ ì ìš©ë˜ëŠ” outline ìŠ¤íƒ€ì¼ ì œê±°
    />
  );

```
> â—***react-virtualized APIì˜ CSS ì •ë³´***  
> ğŸ’¡ List ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ëŸ°ì‹ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤.  
> ğŸ’¡ í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ì˜ css ì •ë³´ë¥¼ props ìœ¼ë¡œ ì ìš© í•´ì•¼í•œë‹¤. 
> ğŸ’¡ ê·¸ëŸ¬ë©´ ì´ ì»´í¬ë„ŒíŠ¸ê°€ ì „ë‹¬ ë°›ì€ propsë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ ìµœì í™” í•´ì¤€ë‹¤.

### STEP3. TodoList.js
```js
import React, {useCallback} from "react";
import {List} from 'react-virtualized';
import TodoListItem from "./TodoListItem";
import './scss/TodoList.scss';

const TodoList = ({ todos, onRemove, onToggle }) => {
    const rowRenderer = useCallback (
        ({ index, key, style }) => {
            const todo = todos[index];
            return (
                <TodoListItem 
                    todo={todo} 
                    key={key} 
                    onRemove={onRemove}
                    onToggle={onToggle}
                    style={style}
                />
            );
        },
        [onRemove, onToggle, todos],
    )
    return (
        <List 
            className="TodoList"
            width={512}
            height={513}
            rowCount={todos.length}
            rowHeight={57}
            rowRenderer={rowRenderer}
            list={todos}
            style={{ outline: 'none' }}
        />
    );
}

export default React.memo(TodoList);

```

> â—***React.memo ê³¼ì •***  
> ğŸ’¡ ìƒë‹¨ì—ì„œ ì„í¬íŠ¸í•˜ë©´ List ì»´í¬ë„ŒíŠ¸ë¥¼ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.  
> ğŸ’¡ í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ì˜ ì „ì²´ í¬ê¸°ì™€ ê° í•­ëª©ì˜ ë†’ì´, ê° í•­ëª©ì„ [ë Œë”ë§í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜], ê·¸ë¦¬ê³  [ë°°ì—´ì„ props]ë¡œ ë˜ì ¸ì£¼ë©´  
> ğŸ’¡ List ì»´í¬ë„ŒíŠ¸ê°€ ì „ë‹¬ë°›ì€ propsë¥¼ ì‚¬ìš©í•´ ìë™ìœ¼ë¡œ ìµœì í™” í•´ì¤€ë‹¤.  
>   
> ê·¸ë¦¬ê³  ê° ë¦¬ìŠ¤íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” TodoListItem.jsë¥¼ ìˆ˜ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.


### STEP4. TodoListItem.js
```js
const TodoListItem = ({ todo, onRemove, onToggle, style }) => {
    const { id, text, checked } = todo;
    
    return (
        <div className='TodoListItem-virtualized' style={style} >
            (...)
        </div>
    )
}

export default React.memo(TodoListItem);

```

> ğŸ’¡ style í”„ë¡­ìŠ¤ê°€ ì¶”ê°€ë˜ì—ˆë‹¤. ëˆ„ë½í•˜ì§€ ë§ì!

### STEP4. TodoListItem.scss
```css
//ì¶”ê°€
.TodoListItem-virtualized {
  & + & {
    border-top: 1px solid #dee2e6;
  }
  &:nth-child(even) {
    background: #f8f9fa;
  }
}

```

> â—***React.memo ê³¼ì •***  
> ğŸ’¡ ìƒë‹¨ì—ì„œ ì„í¬íŠ¸í•˜ë©´ List ì»´í¬ë„ŒíŠ¸ë¥¼ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.  
> ğŸ’¡ í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ì˜ ì „ì²´ í¬ê¸°ì™€ ê° í•­ëª©ì˜ ë†’ì´, ê° í•­ëª©ì„ [ë Œë”ë§í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜], ê·¸ë¦¬ê³  [ë°°ì—´ì„ props]ë¡œ ë˜ì ¸ì£¼ë©´  
> ğŸ’¡ List ì»´í¬ë„ŒíŠ¸ê°€ ì „ë‹¬ë°›ì€ propsë¥¼ ì‚¬ìš©í•´ ìë™ìœ¼ë¡œ ìµœì í™” í•´ì¤€ë‹¤.  