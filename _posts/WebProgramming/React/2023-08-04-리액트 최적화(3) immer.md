---
title:  "λ¦¬μ•΅νΈ μµμ ν™”(3) immer"
excerpt: "λ¦¬μ•΅νΈ μµμ ν™”(3) immer μ…λ‹λ‹¤."

categories:
  - react
tags:
  - [react]

toc: true
toc_sticky: true

last_modified_at: 2023-08-04T09:00:00-18:00:00
---

## immer λ€?
> β—***immer(μ΄λ¨Έ)***  
> π’΅ JavaScriptμ—μ„ λ¶λ³€μ„±μ„ μ μ§€ν•λ©΄μ„ μƒνƒλ¥Ό κ°„νΈν•κ² μ—…λ°μ΄νΈν•  μ μλ„λ΅ λ„μ™€μ£Όλ” λΌμ΄λΈλ¬λ¦¬.  
> π’΅ immerλ” λ³µμ΅ν• μ¤‘μ²©λ κ°μ²΄λ‚ λ°°μ—΄μ„ λ‹¤λ£° λ• μ½”λ“λ¥Ό λ” μ½κΈ° μ‰½κ³  μ μ§€λ³΄μν•κΈ° μ‰½κ² λ§λ“ λ‹¤.  

## λ¶λ³€μ„± μ¬ν•™μµ  
### μμ 1 (λ¶λ³€μ„± μ§€ν‚¤κΈ° κΈ°λ³Έ) 

```js
const object = {
  a: 1,
  b: 2
};

object.b = 3;

```  
> β οΈ μ΄λ ‡κ² μ§μ ‘ μμ •ν•λ©΄ μ•λκ³  !

```js
const object = {
  a: 1,
  b: 2
};

const nextObject = {
  ...object,
  b: 3
};

```
> π’΅ μ΄λ ‡κ² μ–•μ€λ³µμ‚¬λ΅ μ‚¬μ©ν•΄μ„ λ¶λ©΄μ„±μ„ μ§€ν‚¤λ©° μƒλ΅μ΄ κ°μ²΄λ¥Ό λ§λ“¤κ³  μμ •ν•΄μ•Όν•λ‹¤.
  
### μμ 2 (λ¶λ³€μ„± μ§€ν‚¤κΈ° λ°°μ—΄)  
```js
const todos = [
  {
    id: 1,
    text: 'ν•  μΌ #1',
    done: true
  }}
];
const inserted = todos.concat({
  id: 3,
  text: 'ν•  μΌ #3',
  done: false
});

```

> π’΅ λ°°μ—΄λ„ concat μ„ μ‚¬μ©ν•΄μ„ λ¶λ©΄μ„±μ„ μ§€ν‚¤λ©° μƒλ΅μ΄ κ°μ²΄λ¥Ό λ§λ“¤κ³  μμ •ν•΄μ•Όν•λ‹¤.  
> π’΅ push, splice λ“±μ ν•¨μλ¥Ό μ‚¬μ©ν•κ±°λ‚ n λ²μ§Έ ν•­λ©μ„ μ§μ ‘ μμ •ν•λ©΄ μ•λλ‹¤.

### μμ 2 (λ¶λ³€μ„± μ§€ν‚¤κΈ° λ°°μ—΄ μ‹¬ν™”)  
```js
const state = {
  posts: [
    {
      id: 1,
      title: 'μ λ©μ…λ‹λ‹¤.',
      body: 'λ‚΄μ©μ…λ‹λ‹¤.',
      comments: [
        {
          id: 1,
          text: 'μ™€ μ •λ§ μ μ½μ—μµλ‹λ‹¤.'
        }
      ]
    },
    {
      id: 2,
      title: 'μ λ©μ…λ‹λ‹¤.',
      body: 'λ‚΄μ©μ…λ‹λ‹¤.',
      comments: [
        {
          id: 2,
          text: 'λ λ‹¤λ¥Έ λ“κΈ€ μ–΄μ©κ³  μ €μ©κ³ '
        }
      ]
    }
  ],
  selectedId: 1
};

```

> π’΅ μ„ μ½”λ“μ—μ„ posts λ°°μ—΄ μ•μ id κ°€ 1 μΈ post κ°μ²΄λ¥Ό μ°Ύμ•„μ„, comments μ— μƒλ΅μ΄ λ“κΈ€ κ°μ²΄λ¥Ό μ¶”κ°€ν•΄μ¤μ•Ό ν•λ‹¤λ©΄? 

```js
// λ°©λ²•1
const nextState = {
  ...state,
  posts: state.posts.map(post =>
    post.id === 1
      ? {
          ...post,
          comments: post.comments.concat({
            id: 2,
            text: 'μƒλ΅μ΄ λ“κΈ€'
          })
        }
      : post
  )
};

```
```js
// λ°©λ²•2
const info = {
  id: 2,
  text: 'μƒλ΅μ΄ λ“κΈ€'
};

const nextState = {
  ...state,
  posts: state.posts.map(post =>
    post.id === 1
      ? {
          ...post,
          comments: post.comments.concat(info)
        }
      : post
  )
};

```


> π’΅ μ„ μ²λΌ λ¶λ³€μ„± ν•λ‚ μ§€ν‚¤λ”λ° μ§„μ§ λ³µμ΅ν•λ‹¤.  
> π’΅μ΄λ΄ λ•, immer λΌλ” λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•λ©΄ μ—„μ²­ νΈν•κ² λ¶λ³€μ„± μ΅°μ‘μ΄ κ°€λ¥ν•λ‹¤.


## Immer μ‚¬μ©λ²•
### STEP1. yarn add immer
```bash
yarn add immer

```
```js
import produce from 'immer';

```
> π’΅μ½”λ“μ μƒλ‹¨μ—μ„ immer λ¥Ό μ„ μ²λΌ μ‚¬μ©ν•λ‹¤.  
> π’΅λ³΄ν†µ produce λΌλ” μ΄λ¦„μΌλ΅ λ¶λ¬μ¨λ‹¤.  



### STEP2. μ½”λ“
```js
import produce from "immer";

const state = {
  number: 1,
  dontChangeMe: 2
};

const nextState = produce(state, draft => {
  draft.dontChangeMe += 1;
});

console.log(nextState);

```

> β—***μ΄λ¨Έ νλΌλ―Έν„°κ°’***  
> 1. π’΅param1: μμ •ν•κ³  μ‹¶μ€ μƒνƒ  
> 2. π’΅param2: μ–΄λ–»κ² μ—…λ°μ΄νΈν•κ³  μ‹¶μ„μ§€ μ •μν•λ” ν•¨μλ¥Ό λ„£λ”λ‹¤.  
> 3. π’΅λ¶λ³€μ„± μ‹ κ²½μ“°μ§€ μ•κ³  μ—…λ°μ΄νΈ κ°€λ¥ν•λ‹¤. λ.   

λ‘λ²μ§Έ νλΌλ―Έν„°μ— λ„£λ” ν•¨μμ—μ„λ” κ·Έλƒ¥ μ—…λ°μ΄νΈ ν•΄μ£Όλ©΄ λ‹¤ μ•μ•„μ„ ν•΄μ¤λ‹λ‹¤.
